# Parte 3 - Top 10

## Análise dos TOP 10 maiores cantores e músicas do Spotify.

Esta análise visa responder a seguinte questão: <b>O conjunto das top 10 músicas e dos top 10 artistas varia muito se considerarmos apenas musicas lançadas no mesmo ano? </b>

Para respondê-la, desenvolvemos quatro histogramas e dividimo-los em dois grupos: os que analisam os cantores e os que analisam as músicas.

Para os que analisam os cantores, temos:

<div class="grid grid-cols-2">
    <div id="ex01" class="card">
        <h1>Top 10 maiores cantores em todo o período analisado (A1).</h1>
   <div style="width: 100%; margin-top: 15px;">
            ${ vl.render(ex01(divWidth)) }
        </div>
    </div>
    <div id="ex02" class="card">
        <h1>Top 10 maiores cantores com  músicas lançadas em 2023 (A2).</h1>
        <div style="width: 100%; margin-top: 15px;">
            ${ vl.render(ex02(divWidth)) }
        </div>
    </div>
</div>

Os histogramas acima denominados A1 e A2, representam, respectivamente, os 10 cantores mais ouvidos se considerado todo o período disponibilizado no banco de dados disponibilizado no endereço: https://www.kaggle.com/datasets/nelgiriyewithana/top-spotify-songs-2023 e os 10 cantores mais ouvidos se considerado apenas as músicas lançadas no ano de 2023, mesmo ano do banco de dados anteriormente mencionado.

#### Ao analisá-los, respondemos que SIM, há uma grande variação da composição dos 10 cantores mais ouvidos.


Já para as músicas, temos:

<div class="grid grid-cols-2">
    <div id="ex03" class="card">
        <h1>Top 10 músicas mais ouvidas em todo o período analisado</h1>
        <div style="width: 100%; margin-top: 15px;">
             ${ vl.render(ex03(divWidth)) }
        </div>
    </div>
    <div id="ex04" class="card">
        <h1>Top 10 músicas mais ouvidas que foram lançadas em 2023</h1>
        <div style="width: 100%; margin-top: 15px;">
             ${ vl.render(ex04(divWidth)) }
        </div>
    </div>
</div>

Os histogramas acima denominados B1 e B2, representam, respectivamente, as 10 músicas mais ouvidas se considerado todo o período disponibilizado no banco de dados disponibilizado no endereço: https://www.kaggle.com/datasets/nelgiriyewithana/top-spotify-songs-2023 e as 10 mais ouvidas se considerado apenas aquelas lançadas no ano de 2023, mesmo ano do banco de dados anteriormente mencionado.

#### Ao analisá-los, respondemos que SIM, houve 80% de variação da composição das 10 músicas mais ouvidos.

```js
const divWidth = 345;
const divheight = 300;

```


```js
import * as vega from "npm:vega";
import * as vegaLite from "npm:vega-lite";
import * as vegaLiteApi from "npm:vega-lite-api";

const vl = vegaLiteApi.register(vega, vegaLite);

const spotify = await FileAttachment("./data/spotify-2023.json").json({typed: true});

function ex01(divWidth) {
   return {
        spec: {
            width: divWidth,
            height: divheight,
            data: {
                values: spotify
            },
            "mark": {
                "type": "bar"
            },
            "transform": 
           [{
                "aggregate": 
                [{
                    "field": ["streams"],
                    "op": "sum", 
                    "as": "rank",
                }],
                "groupby": ["artist(s)_name"],
            },
            {
                "filter": "datum.rank >= 5000000000"
            }],      
                   
            "encoding": {
                "x": {
                    "field": ["artist(s)_name"],
                    "type": "nominal",
                    "aggregate": "artist(s)_name",
                    "sort": {
                        "field": "rank",
                        "order": "descending"
                    },            
                },
                "y": {
                   "field": ["rank"],
                    "type": "quantitative",
                }
            }
        }
    }
}

function ex02(divWidth) {
   return {
        spec: {
            width: divWidth,
            height: divheight,
            data: {
                values: spotify
            },
            "mark": {
                "type": "bar"
            },
            "transform": 
           [{
                "aggregate": 
                [{
                    "field": ["streams"],
                    "op": "sum", 
                    "as": "rank",
                }],
                "groupby": ["artist(s)_name","released_year"],

            },
            {"filter": "datum.released_year == 2023 && datum.rank >= 510000000"},
         
            ],      
                   
            "encoding": {
                "x": {
                    "field": ["artist(s)_name"],
                    "type": "nominal",
                    "aggregate": "artist(s)_name",
                    "sort": {
                        "field": "rank",
                        "order": "descending"
                    },            
                },
                "y": {
                   "field": ["rank"],
                    "type": "quantitative",
                }
            }
        }
    }
}

function ex03(divWidth) {
  return {
        spec: {
            width: divWidth,
            height: divheight,
            data: {
                values: spotify
            },
            "mark": {
                "type": "bar"
            },
            "transform": 
           [{
                "aggregate": 
                [{
                    "field": ["streams"],
                    "op": "sum", 
                    "as": "rank",
                }],
                "groupby": ["track_name"],
            },
            {
                "filter": "datum.rank >= 2560000000"
            }],      
                   
            "encoding": {
                "x": {
                    "field": ["track_name"],
                    "type": "nominal",
                    "aggregate": "track_name",
                    "sort": {
                        "field": "rank",
                        "order": "descending"
                    },            
                },
                "y": {
                   "field": ["rank"],
                    "type": "quantitative",
                }
            }
        }
    }
}

function ex04(divWidth) {
   return {
        spec: {
            width: divWidth,
            height: divheight,
            data: {
                values: spotify
            },
            "mark": {
                "type": "bar"
            },
            "transform": 
           [{
                "aggregate": 
                [{
                    "field": ["streams"],
                    "op": "sum", 
                    "as": "rank",
                }],
                "groupby": ["track_name","released_year"],

            },
            {"filter": "datum.released_year == 2023 && datum.rank >= 430000000"},
         
            ],      
                   
            "encoding": {
                "x": {
                    "field": ["track_name"],
                    "type": "nominal",
                    "aggregate": "track_name",
                    "sort": {
                        "field": "rank",
                        "order": "descending"
                    },            
                },
                "y": {
                   "field": ["rank"],
                    "type": "quantitative",
                }
            }
        }
    }
}
```
