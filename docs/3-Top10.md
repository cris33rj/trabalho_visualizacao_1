<style> 
    p, table, figure, figcaption, h1, h2, h3, h4, h5, h6, .katex-display 
    {
        max-width:none;
        text-align: justify;
        margin: 15px 15px;
        text-wrap: pretty;
    }
</style>
# Parte 3 - Top 10

## Análise dos TOP 10 maiores cantores e músicas mais ouvidas do Spotify.

Esta análise visa responder a seguinte questão: O conjunto das top 10 músicas e dos top 10 artistas varia muito se considerarmos apenas musicas lançadas no mesmo ano?

Para respondê-la, desenvolvemos quatro histogramas e dividimo-los em dois grupos: <br>
1) os que analisam os cantores; e <br>
2) os que analisam as músicas.

No primeiro grupo, analisaremos os cantores:

<div class="grid grid-cols-2">
    <div id="ex01" class="card">
        <h4>Top 10 maiores cantores em todo o período analisado. (A1)</h4>
   <div style="width: 100%; margin-top: 15px;">
            ${ vl.render(ex01(divWidth-15)) }
        </div>
    </div>
    <div id="ex02" class="card">
        <h4>Top 10 maiores cantores com  músicas lançadas em 2023. (A2)</h4>
        <div style="width: 100%; margin-top: 15px;">
            ${ vl.render(ex02(divWidth)) }
        </div>
    </div>
</div>

Os histogramas acima denominados A1 e A2, representam, respectivamente, os 10 cantores mais ouvidos se considerado todo o período disponibilizado no banco de dados disponibilizado no endereço: https://www.kaggle.com/datasets/nelgiriyewithana/top-spotify-songs-2023 e os 10 cantores mais ouvidos se considerado apenas as músicas lançadas no ano de 2023, mesmo ano do banco de dados anteriormente mencionado.

#### Ao analisá-los, evidenciamos que há uma grande variação da composição dos 10 cantores mais ouvidos.


Analisando o grupo correspondente às músicas, temos:

<div class="grid grid-cols-2">
    <div id="ex03" class="card">
        <h4>Top 10 músicas mais ouvidas em todo o período analisado. B1</h4>
        <div style="width: 100%; margin-top: 15px;">
             ${ vl.render(ex03(divWidth)) }
        </div>
    </div>
    <div id="ex04" class="card">
        <h4>Top 10 músicas mais ouvidas que foram lançadas em 2023. B2</h4>
        <div style="width: 100%; margin-top: 15px;">
             ${ vl.render(ex04(divWidth)) }
        </div>
    </div>
</div>

Os histogramas acima denominados B1 e B2, representam, respectivamente, as 10 músicas mais ouvidas se considerado todo o período disponibilizado no banco de dados disponibilizado no endereço: https://www.kaggle.com/datasets/nelgiriyewithana/top-spotify-songs-2023 e as 10 mais ouvidas se considerado apenas aquelas lançadas no ano de 2023, mesmo ano do banco de dados anteriormente mencionado.

#### Ao analisá-los, observamos que houve 80% de variação da composição das 10 músicas mais ouvidas.

Dito isto, concluí-se que nos dois caos, dos top 10 cantores e músicas nais ouvidos, ao se comparar todo o período e apenas as músicas lançadas no anos de 2023, há uma variação de mais de 70% em ambos os casos.

```js
const divWidth = 365;
const divheight = 300;

```


```js
import * as vega from "npm:vega";
import * as vegaLite from "npm:vega-lite";
import * as vegaLiteApi from "npm:vega-lite-api";

const vl = vegaLiteApi.register(vega, vegaLite);

const spotify = await FileAttachment("./data/spotify-2023.json").json({typed: true});

function ex01(divWidth) {
   return {
        spec: {
            width: divWidth,
            height: divheight,
            padding: 15,            
            data: {
                values: spotify
            },
            "mark": {
                "type": "bar",
                "size": 26,
            },
            "transform": 
           [{
                "aggregate": 
                [{
                    "field": ["streams"],
                    "op": "sum", 
                    "as": "Stream_total",
                }],
                "groupby": ["artist(s)_name"],
            },
            {
                "filter": "datum.Stream_total >= 5000000000"
            }],      
                   
            "encoding": {
                "x": {
                    "field": ["artist(s)_name"],
                    "type": "nominal",
                    "aggregate": "artist(s)_name",
                    "sort": {
                        "field": "Stream_total",
                        "order": "descending"
                    },        
                    "title": "Nome(s) do(s) Cantor(es)",                                  
                },
                "y": {
                   "field": ["Stream_total"],
                    "type": "quantitative",
                    "title": "Total de Streams",    
                }
            }
        }
    }
}

function ex02(divWidth) {
   return {
        spec: {
            width: divWidth,
            height: divheight,
            padding: 15,            
            data: {
                values: spotify
            },
            "mark": {
                "type": "bar",
                "size": 26,
            },
            "transform": 
           [{
                "aggregate": 
                [{
                    "field": ["streams"],
                    "op": "sum", 
                    "as": "stream_total",
                }],
                "groupby": ["artist(s)_name","released_year"],

            },
            {"filter": "datum.released_year == 2023 && datum.stream_total >= 510000000"},
         
            ],      
                   
            "encoding": {
                "color": {"value": "green"},                
                "x": {
                    "field": ["artist(s)_name"],
                    "type": "nominal",
                    "aggregate": "artist(s)_name",
                    "sort": {
                        "field": "stream_total",
                        "order": "descending"
                    },  
                    "title": "Nome(s)_do(s)_Cantor(es)",          
                },
                "y": {
                   "field": ["stream_total"],
                    "type": "quantitative",
                    "title": "Total de Streams",                        
                }
            }
        }
    }
}

function ex03(divWidth) {
  return {
        spec: {
            width: divWidth,
            height: divheight,
            padding: 15,            
            data: {
                values: spotify
            },
            "mark": {
                "type": "bar",
                "size": 26,
            },
            "transform": 
           [{
                "aggregate": 
                [{
                    "field": ["streams"],
                    "op": "sum", 
                    "as": "Stream_total",
                }],
                "groupby": ["track_name"],
            },
            {
                "filter": "datum.Stream_total >= 2560000000"
            }],      
                   
            "encoding": {
                "color": {"value": "brown"},                
                "x": {
                    "field": ["track_name"],
                    "type": "nominal",
                    "aggregate": "track_name",
                    "sort": {
                        "field": "Stream_total",
                        "order": "descending"
                    },    
                    "title": "Nome da música",        
                },
                "y": {
                   "field": ["Stream_total"],
                    "type": "quantitative",
                    "title": "Total de Streams",    
                }
            }
        }
    }
}

function ex04(divWidth) {
   return {
        spec: {
            width: divWidth,
            height: divheight,
            padding: 15,            
            data: {
                values: spotify
            },
            "mark": {
                "type": "bar",
                "size": 26,
            },
            "transform": 
           [{
                "aggregate": 
                [{
                    "field": ["streams"],
                    "op": "sum", 
                    "as": "Stream_total",
                }],
                "groupby": ["track_name","released_year"],
            },
            {"filter": "datum.released_year == 2023 && datum.Stream_total >= 430000000"},
         
            ],      
                   
            "encoding": {
                "color": {"value": "gray"},
                "x": {
                   "field": ["track_name"],
                    "type": "nominal",
                    "aggregate": "track_name",
                    "sort": {
                        "field": "Stream_total",
                        "order": "descending"
                    },  
                    "title": "Nome da música",

                },
                "y": {
                   "field": ["Stream_total"],
                    "type": "quantitative",
                    "title": "Total de Streams",    
                }
            }
        }
    }
}
```
